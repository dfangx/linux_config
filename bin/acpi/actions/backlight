#!/bin/bash

# Gentoo
direction="$1"
scale="$2"
backlight_dir=/sys/class/backlight/intel_backlight
max="$(cat $backlight_dir/max_brightness)"
step="$(echo $max*$scale*$direction | bc)"
current="$(cat "$backlight_dir"/brightness)"
new="$(printf '%.0f' $(echo $current+$step | bc))"

if [ "$new" -ge "$max" ]; then
    echo "$max" > "$backlight_dir"/brightness
elif [ "$new" -le 0 ]; then
    echo 0 > "$backlight_dir"/brightness
else
    echo "$new" > "$backlight_dir"/brightness
fi

exec pkill -RTMIN+2 bar
